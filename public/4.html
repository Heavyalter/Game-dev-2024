<body id="myBody" onload="{
  clearInterval(myTimer02);
  myTimer02 = setInterval(function(){
    let my02x = Math.floor((Math.random() * 20) - 9);
    let my02y = Math.floor((Math.random() * 20) - 9);
    document.getElementById('myImg02').style.left = parseInt(document.getElementById('myImg02').style.left) + my02x + 'px';
    document.getElementById('myImg02').style.top  = parseInt(document.getElementById('myImg02').style.top)  + my02y + 'px';
    myCheckHit();
  }, 50);
}" style="background-image: url('https://external-preview.redd.it/fhkU2h_KoqELvDHZPjgjaSnD_dJjnDVj3qE0-b7Ih3g.jpg?auto=webp&s=4dfd06d8ae8ead160b7679c77209263ade1c86fb'); background-repeat: repeat; background-size: 80%;">

<h1 align=center><font color=red>T4A08 Random Move by Fred</font></h1>

<!-- Show key press -->
<div id="myDiv01" style="font-size: 20px; color: red;">Press WASD to move</div>

<script>
// Global variables here
let myTimer02;
let keysHeld = { w: false, a: false, s: false, d: false };
const enemyWidth = 100;  // Assuming enemy's width is 100px

// Global functions here
function myHitOther(my1, my2) {
  left1 = parseInt(document.getElementById(my1).style.left);
  right1 = left1 + parseInt(document.getElementById(my1).style.width);
  top1 = parseInt(document.getElementById(my1).style.top);
  bottom1 = top1 + parseInt(document.getElementById(my1).style.height);
  left2 = parseInt(document.getElementById(my2).style.left);
  right2 = left2 + parseInt(document.getElementById(my2).style.width);
  top2 = parseInt(document.getElementById(my2).style.top);
  bottom2 = top2 + parseInt(document.getElementById(my2).style.height);

  if ((right1 >= left2) && (bottom1 >= top2) && (left1 <= right2) && (top1 <= bottom2)) {
    return true;
  }
  return false;
}

function myCheckHit() {
  if (myHitOther('myImg01', 'myImg02') || myHitOther('myImg01', 'myImg03') || myHitOther('myImg01', 'myImg04')) {
    // Reset the player's position and the enemy's position if they collide
    document.getElementById('myImg01').style.left = '20px';
    document.getElementById('myImg01').style.top = '190px';
    resetEnemies(); // Reset enemies to the right edge
    alert('You collided with an enemy! Game reset.');

    // Reset the keys held state after collision
    resetKeys();
  }

  // Check if the player has passed the right edge of the screen
  let playerLeft = parseInt(document.getElementById('myImg01').style.left);
  let screenWidth = window.innerWidth;
  if (playerLeft > screenWidth - document.getElementById('myImg01').width) {
    alert('You reached the right edge! You win!');
    
    // Reset the player's position
    document.getElementById('myImg01').style.left = '20px';
    document.getElementById('myImg01').style.top = '190px';

    // Reset the enemies' positions to the right edge
    resetEnemies();

    // Reset the keys held state after winning
    resetKeys();
  }

  // Check for window boundaries for player and enemy
  if (parseInt(document.getElementById('myImg01').style.left) > window.innerWidth - document.getElementById('myImg01').width) {
    document.getElementById('myImg01').style.left = '10px';
  }
}

// Movement with WASD keys
function moveWithWASD() {
  let character = document.getElementById('myImg01');
  let left = parseInt(character.style.left || '0');
  let top = parseInt(character.style.top || '0');

  // Move the character based on the held keys
  if (keysHeld['w']) character.style.top = (top - 2) + 'px'; // Move up slower
  if (keysHeld['a']) character.style.left = (left - 2) + 'px'; // Move left slower
  if (keysHeld['s']) character.style.top = (top + 2) + 'px'; // Move down slower
  if (keysHeld['d']) character.style.left = (left + 2) + 'px'; // Move right slower

  // Update the key pressed info on the screen
  document.getElementById('myDiv01').innerHTML = 'You pressed: ' + Object.keys(keysHeld).filter(key => keysHeld[key]).join(', ');

  // Check for collisions after movement
  myCheckHit();
}

// Move enemy towards the player (generalized for all enemies)
function moveEnemyTowardsPlayer(enemyId) {
  let enemy = document.getElementById(enemyId);
  let player = document.getElementById('myImg01');

  let enemyLeft = parseInt(enemy.style.left);
  let playerLeft = parseInt(player.style.left);
  let enemyTop = parseInt(enemy.style.top);
  let playerTop = parseInt(player.style.top);

  // Move the enemy towards the player
  if (enemyLeft < playerLeft) {
    enemy.style.left = (enemyLeft + 0.5) + 'px';  // Enemy moves slowly towards the player
  } else if (enemyLeft > playerLeft) {
    enemy.style.left = (enemyLeft - 0.5) + 'px';  // Enemy moves slowly towards the player
  }

  if (enemyTop < playerTop) {
    enemy.style.top = (enemyTop + 0.5) + 'px';  // Enemy moves slowly towards the player
  } else if (enemyTop > playerTop) {
    enemy.style.top = (enemyTop - 0.5) + 'px';  // Enemy moves slowly towards the player
  }

  // Check for collisions after enemy movement
  myCheckHit();
}

// Start the enemy movement when the page loads
setInterval(function() {
  moveEnemyTowardsPlayer('myImg02');
  moveEnemyTowardsPlayer('myImg03');
  moveEnemyTowardsPlayer('myImg04');
}, 10);

// Handle keydown for continuous movement
window.onkeydown = function(event) {
  if (['w', 'a', 's', 'd'].includes(event.key.toLowerCase())) {
    keysHeld[event.key.toLowerCase()] = true;
  }
};

// Handle keyup to stop movement
window.onkeyup = function(event) {
  if (['w', 'a', 's', 'd'].includes(event.key.toLowerCase())) {
    keysHeld[event.key.toLowerCase()] = false;
  }
};

// Function to reset the key held state
function resetKeys() {
  keysHeld = { w: false, a: false, s: false, d: false };
  document.getElementById('myDiv01').innerHTML = 'You pressed: ';
}

// Function to reset all enemies' positions to the right edge
function resetEnemies() {
  const screenWidth = window.innerWidth;
  // Reset each enemy to spawn at the right edge
  document.getElementById('myImg02').style.left = (screenWidth - enemyWidth) + 'px';  
  document.getElementById('myImg02').style.top = '190px'; 

  document.getElementById('myImg03').style.left = (screenWidth - enemyWidth) + 'px';  
  document.getElementById('myImg03').style.top = '290px'; 

  document.getElementById('myImg04').style.left = (screenWidth - enemyWidth) + 'px';  
  document.getElementById('myImg04').style.top = '390px'; 
}

// Continuously update movement
setInterval(moveWithWASD, 10);
</script>

<!-- Images -->
<img id="myImg01" src="myImgNew.jpg" title="myImg01" style="position:absolute; width:100px; height:80px; left: 50px; top:190px;">
<img id="myImg02" src="myImgNew.jpg" title="myImg02" style="position:absolute; width:100px; height:80px; left:350px; top:190px;">
<img id="myImg03" src="myImgNew.jpg" title="myImg03" style="position:absolute; width:100px; height:80px; left:500px; top:190px;">
<img id="myImg04" src="myImgNew.jpg" title="myImg04" style="position:absolute; width:100px; height:80px; left:500px; top:400px;">

</body>
